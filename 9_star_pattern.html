<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Star Pattern</title>
    <style type="text/css">
    * {
      margin: 0;
      padding: 0;
    }
    body {
      /*background-color: red;*/
      background-color: #161e29;
      overflow: hidden;
    }
    h1 {
        position: absolute;
        top: 45vh;
        left: 5vw;
    }
    .overlay {
        /*position: absolute;
        opacity: .85;
        z-index: 10000;
    	  border-bottom: 100vw solid red;
        border-right: 25vw solid transparent;
    	height: 0;
    	width: 50vw;*/
      position: absolute;
      /*background-color: red;*/
      background-color: #161e29;
      opacity: .98;
      z-index: 10000;
      margin: 0;
      padding: 0;
      width: 100vw;
      height: 110vh;
    }
    svg {
      overflow: hidden;
      width: 100vw;
      height: 110vh;
    }
    /*.star-lines path {
        animation: createBox 5s infinite;
    }
    @keyframes createBox {
     0% {
        transform: scale(.2);
      }
      50% {
        opacity: .5;
        transform: scale(.5);
      }
      100% {
        transform: scale(1);
      }
    }*/
    </style>
  </head>
  <body>
    <div class="overlay">
        <h1 data-letters="Take Your Heart"></h1>
    </div>
        <svg width="100" height="120" viewBox="0 0 521.2 524.77" id="star-box" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">

        <symbol id="symbol-star" viewBox="0 0 1000 1000">
            <path id="star-base" fill="#fff" d="M228.47 0l114.24 146.36H521.2L417.67 296.3l57.12 171.35-174.92-53.55-149.94 110.67V339.14L0 232.04l174.92-57.12L228.47 0z"/>
                <g class="star-lines">
                    <path class="star-line-1" d="M234 29.82L331.67 155l4.2 5.39h158.65l-88.37 128-4 5.75 2.21 6.63 48.53 145.59-149-45.6-6.74-2.06-5.67 4.19L163.93 497V331.93l-5.86-4.19-127.39-91 148.59-48.52 6.91-2.26 2.13-7L234 29.82M228.47 0l-53.55 174.92L0 232l149.93 107.1v185.67L299.87 414.1l174.92 53.55-57.12-171.35L521.2 146.36H342.71L228.47 0z" />
                    <path d="M246.25 95.34l71.44 89.38 4.13 5.17 6.62.09 106.79 1.4-62.54 93-3.78 5.62 2.09 6.4 32.81 102.81-107.68-31.49-6.56-1.92-5.55 4-90.61 65.15L192 321.38l-.09-7-5.63-4.13-88.76-65.1L203.91 209l6.67-2.27 2.15-6.71 33.52-104.68m-5.37-29.14L199.4 195.7 67.59 240.57l110.43 81L179.75 462l112.45-80.84L425.13 420l-40.81-127.9 77-114.43L328.63 176 240.88 66.21z"/>
                    <path d="M258.38 160.29l45.43 54.29 4 4.76 6.2.25 62.48 2.5-37.31 58.38-3.42 5.35 1.77 6.09 17.6 60.63-67-17.83L282 333l-5.29 3.6-54 36.78-2.55-70-.24-6.55-5.19-4-50.97-39.33 65-23.88 6.2-2.28 2.18-6.24 21.28-60.82m-5.08-27.88l-29.42 84.08-88.7 32.61L206.1 304l3.47 95.29 75-51 90.93 24.21L351 288l50.44-78.93-86.85-3.47-61.29-73.19z"/>
                    <path d="M269.94 223.39l20.38 21.46 3.44 3.62 5 .63 20.59 2.61-14 25.38-2.47 4.48 1 5 4.1 20.49-28.42-5.54-5.08-1-4.5 2.55-18.88 10.7-3-28.85-.55-5.29-3.91-3.63L228 261.7l26.1-11.65 4.88-2.18 2.19-4.87 8.8-19.61m-4.22-24.78l-17.35 38.65-45.59 20.35 31.41 28.76 5.2 50.12 37.48-21.22 48.93 9.55-8.21-41 23.9-43.43-41-5.2-34.75-36.59z"/>
                    <path d="M272.84 258.05l-2.48 8.09-8.09 2.65 6.94 4.95v8.59l6.93-5.12 8.1 2.48-2.65-7.93 4.79-6.94h-8.25l-5.29-6.77z" transform="translate( -100 -100)"/>
              <animateTransform
                attributeType="xml"
                attributeName="transform"
                type="scale"
                from="0"
                by="1"
                dur="2s"
                fill="freeze"
                repeatCount="1"
                />
            <!-- <animate
                attributeType="xml"
                attributeName="fill-opacity"
                    from="0"
                    to="0"
                    values="0;0.5;0"
                dur="2s"
                repeatCount="indefinite"
                fill="freeze" />   -->
                   <!-- <animateTransform attributeName="transform" type="scale" additive="sum" from="0 0" to="1 1" begin="0s" dur="2.5s" repeatCount="1"></animateTransform> -->
          </g>

        </symbol>

        <!-- Display 2 instances with different transform -->
       <!-- <use xlink:href="#symbol-star" fill="#000"
             transform="translate(50 25) rotate(-20) scale(0.75)"/>
        <use xlink:href="symbol-star" fill="#000" fill-opacity="0.5"
             transform="translate(400 0) rotate(45) scale(0.5)"/>    -->



      </svg>

  </body>
  <script type="text/javascript">
  //Original reference by blustemy https://codepen.io/blustemy/pen/NbyGgY
  //http://blustemy.io/making-svg-patterns-with-javascript/

  //P5 inspiration: https://www.youtube.com/watch?v=asnaiozGiJs
  //https://www.youtube.com/watch?v=bE_ZuNp1CTI
  //TODO half page mask (red)
  //scale strokes
  //remove opacity

  class Patterns {
      constructor({ svg, symbol }) {
          this.svgElement = svg;
          this.symbolElement = symbol;
          this.symbolLink = `#${symbol.id}`;
      }

      static get svgNamespace() {
          return "http://www.w3.org/2000/svg";
      }

      static get xlinkNamespace() {
          return "http://www.w3.org/1999/xlink";
      }

      /* Return a random integer between min (included) and max (excluded). */
      static getRandomInt(min, max) {
          const minInt = Math.ceil(min),
                maxInt = Math.floor(max);
          return Math.floor(Math.random() * (maxInt - minInt)) + minInt;
      }

      /* Return a random number between min (inclusive) and max (exclusive). */
      static getRandomArbitrary(min, max) {
          return Math.random() * (max - min) + min;
      }

      addRandomSymbol(parentNode, fill = "#000000", opacity = 1) {
          const useElement = document.createElementNS(Patterns.svgNamespace, "use"),
                width = this.symbolElement.viewBox.baseVal.width,
                height = this.symbolElement.viewBox.baseVal.height,
                x = Patterns.getRandomArbitrary(0, this.svgElement.viewBox.baseVal.width),
                y = Patterns.getRandomArbitrary(0, this.svgElement.viewBox.baseVal.height),
                angle = Patterns.getRandomArbitrary(0, 360), //angle of rotation
                scale = Patterns.getRandomArbitrary(.2, 3); //scale size
          useElement.setAttributeNS(Patterns.xlinkNamespace, "xlink:href", this.symbolLink);
          useElement.setAttribute("width", `${width}`);
          useElement.setAttribute("height", `${height}`);
          useElement.setAttribute("fill", fill);
          useElement.setAttribute("fill-opacity", `${opacity}`);
          useElement.setAttribute("transform", `translate(${x} ${y}) scale(${scale}) rotate(${angle})`);
          parentNode.appendChild(useElement);
      }

      drawRandomSymbols(n = 10, fill = "#000000", opacity = .85) {
          const gElement = document.createElementNS(Patterns.svgNamespace, "g");
          for (let i = 0; i < n; i++) {
              this.addRandomSymbol(gElement, fill, opacity);
          }
          gElement.classList.add("patterns");

          // Add the group.
          this.svgElement.appendChild(gElement);
      }

      clearSymbols() {
          const gElements = this.svgElement.querySelectorAll("g.patterns");
          for (let i = 0; i < gElements.length; i++) {
              this.svgElement.removeChild(gElements[i]);
          }
      }
  }

  document.addEventListener("DOMContentLoaded", () => {
      const patterns = new Patterns({
          svg: document.getElementById("star-box"),
          symbol: document.getElementById("symbol-star")
      });

      patterns.drawRandomSymbols(100, "#000", 1);
      patterns.drawRandomSymbols(5, "#706e71", 1);
      patterns.drawRandomSymbols(25, "#000", 1);
      patterns.drawRandomSymbols(3, "#706e71", 1);

      //call second function that shrinks paths?
  });

  </script>
</html>
